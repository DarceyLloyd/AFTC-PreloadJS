function log(e){console.log(e)}var AFTC=AFTC||{};AFTC.Preloader=function(){function e(){d.noOfFilesLoaded=0,d.noOfJSFiles=0,d.noOfCSSFiles=0;for(var e=0;e<d.que.length;e++){var n=d.que[e];"javascript"==n.type&&d.noOfJSFiles++,"css"==n.type&&d.noOfCSSFiles++}o()}function n(){for(var e=0;e<d.que.length;e++){var n=d.que[e];if(!n.preloading&&!n.preloaded)if(d.noOfJSFilePreloaded<d.noOfJSFiles){if("javascript"==n.type)return n.preloading=!0,n.index=e,n}else if("javascript"!=n.type)return n.preloading=!0,n.index=e,n}return null}function o(){if(d.error)return a(),!1;var e,o=!0;if(d.noOfJSFilePreloaded<d.noOfJSFiles)r(e=n());else{for(t=0;t<d.batchSize;t++)null!=d.batch[t]&&0;for(var t=0;t<d.batchSize;t++)null==d.batch[t]&&null!=(e=n())&&(e.batchIndex=t,d.batch[t]=e,r(e)),null!=d.batch[t]&&(o=!1);o&&l()}}function r(e){$.ajax({url:e.url,success:function(){if("javascript"==e.type){var n=document.createElement("script");n.onload=function(){e.preloading=!1,e.preloaded=!0,d.noOfJSFilePreloaded++,d.noOfFilesLoaded++,t(e),o()},n.src=e.url,document.head.appendChild(n)}else if("css"==e.type){var r=document.getElementsByTagName("head")[0],l=document.createElement("link");l.rel="stylesheet",l.type="text/css",l.href=e.url,l.media="all",l.onload=function(){e.preloading=!1,e.preloaded=!0,d.noOfCSSFilesPreloaded++,d.batch[e.batchIndex]=null,d.noOfFilesLoaded++,t(e),o()},r.appendChild(l)}else e.preloading=!1,e.preloaded=!0,d.batch[e.batchIndex]=null,d.noOfFilesLoaded++,t(e),o()},error:function(n,o,r){var l="# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #\n";l+="AFTC.Preloader(): ERROR: PRELOADER STOPPED! \n",l+="Error on ["+e.url+"]\n",l+="Error ["+o+"]\n",l+="Error ["+r+"]\n",l+="# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #",console.error(l),d.error=!0}})}function l(){d.onComplete&&d.onComplete()}function a(){d.onError&&d.onError()}function t(e){d.percentLoaded=100/d.que.length*d.noOfFilesLoaded*100,d.percentLoaded=Math.round(d.percentLoaded)/100,d.onProgress&&d.onProgress(d.percentLoaded)}var d={que:[],noOfJSFiles:0,noOfJSFilePreloaded:0,noOfCSSFiles:0,noOfCSSFilesPreloaded:0,error:!1,batchSize:4,batch:[],percentLoaded:0,noOfFilesLoaded:0,onComplete:null,onProgress:null,onError:null};return arguments[0]&&"object"==typeof arguments[0]&&(arguments[0].app&&(app=arguments[0].app,renderer=app.getRenderer(),scene=app.getScene()),arguments[0].onComplete&&(d.onComplete=arguments[0].onComplete),arguments[0].onComplete&&(d.onProgress=arguments[0].onProgress),arguments[0].batchSize&&(d.batchSize=arguments[0].batchSize)),{add:function(e,n,o){var r={id:e,url:n,type:o,preloading:!1,preloaded:!1,index:-1,batchIndex:-1};d.que.push(r)},start:function(){e()},noOfFilesLoaded:function(){return d.noOfFilesLoaded},percent:function(){return d.percentLoaded},debug:function(){log(""),log("AFTC Preloader:"),log(d),log("")}}};